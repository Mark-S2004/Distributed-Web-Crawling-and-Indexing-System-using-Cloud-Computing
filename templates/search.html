<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Crawler Search Interface</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .search-result {
            margin-bottom: 2rem;
            padding: 1rem;
            border-bottom: 1px solid #eee;
        }
        .search-result:hover {
            background-color: #f8f9fa;
        }
        .score-badge {
            font-size: 0.8rem;
            color: #6c757d;
        }
        .keywords {
            font-size: 0.9rem;
            color: #28a745;
        }
        .last-updated {
            font-size: 0.8rem;
            color: #6c757d;
        }
        #searchHelp {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Web Crawler Search</h1>
        
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="input-group mb-3">
                    <input type="text" id="searchInput" class="form-control" placeholder="Enter your search query...">
                    <button class="btn btn-primary" onclick="search(1)">Search</button>
                </div>
                <div id="searchHelp">
                    <strong>Search Tips:</strong><br>
                    • Use AND, OR, NOT for boolean search (e.g., "python AND programming")<br>
                    • Use quotes for exact phrases (e.g., "machine learning")<br>
                    • Use field-specific search (e.g., title:github, content:"open source")<br>
                </div>
            </div>
        </div>

        <div id="results" class="mt-4">
            <!-- Search results will be displayed here -->
        </div>

        <div id="pagination" class="d-flex justify-content-center mt-4">
            <!-- Pagination will be displayed here -->
        </div>
    </div>

    <script>
        function search(page) {
            const query = document.getElementById('searchInput').value;
            if (!query) return;

            fetch(`/search?q=${encodeURIComponent(query)}&page=${page}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        document.getElementById('results').innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
                        return;
                    }

                    let resultsHtml = '';
                    if (data.results.length === 0) {
                        resultsHtml = '<div class="alert alert-info">No results found.</div>';
                    } else {
                        data.results.forEach(result => {
                            resultsHtml += `
                                <div class="search-result">
                                    <h4><a href="${result.url}" target="_blank">${result.title}</a></h4>
                                    <p>${result.summary}</p>
                                    <div class="keywords">Keywords: ${result.keywords}</div>
                                    <div class="d-flex justify-content-between align-items-center mt-2">
                                        <span class="score-badge">Relevance Score: ${result.score.toFixed(2)}</span>
                                        <span class="last-updated">Last Updated: ${result.last_updated}</span>
                                    </div>
                                </div>
                            `;
                        });

                        // Add pagination
                        let paginationHtml = '<nav><ul class="pagination">';
                        for (let i = 1; i <= data.total_pages; i++) {
                            paginationHtml += `
                                <li class="page-item ${i === data.page ? 'active' : ''}">
                                    <a class="page-link" href="#" onclick="search(${i})">${i}</a>
                                </li>
                            `;
                        }
                        paginationHtml += '</ul></nav>';
                        document.getElementById('pagination').innerHTML = paginationHtml;
                    }

                    document.getElementById('results').innerHTML = resultsHtml;
                })
                .catch(error => {
                    document.getElementById('results').innerHTML = `<div class="alert alert-danger">Error: ${error}</div>`;
                });
        }

        // Enable search on Enter key press
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                search(1);
            }
        });
    </script>
</body>
</html> 